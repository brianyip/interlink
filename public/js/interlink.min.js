!function(){"use strict";const t=function(){const t=document.querySelector("script[data-user-id]");if(t&&t.src){return new URL(t.src).origin}return window.location.origin}()+"/api/public/links",e="interlink_links_cache",n=3e5,i=/\{\{([^}|]+)(\|custom=([^}]+))?\}\}/g,o=function(t){try{const e=localStorage.getItem(t);if(!e)return null;const n=JSON.parse(e);return Date.now()>n.expiry?(localStorage.removeItem(t),null):n.value}catch(t){return null}},r=function(t,e,n){try{const i={value:e,expiry:Date.now()+n};localStorage.setItem(t,JSON.stringify(i))}catch(t){}};function s(t,e){this.userId=t,this.options=Object.assign({replaceAll:!0,customFallback:function(t,e){return e||"{{"+t+"}}"}},e||{}),this.links=null,this.isLoading=!1}s.prototype={fetchLinks:function(){const i=this,s=e+"_"+this.userId,c=o(s);return c?(this.links=c,Promise.resolve(c)):(this.isLoading||(this.isLoading=!0,this.loadingPromise=fetch(t+"/"+this.userId).then(function(t){if(!t.ok)throw new Error("Failed to fetch links: "+t.status);return t.json()}).then(function(t){return i.links=t,i.isLoading=!1,r(s,t,n),t}).catch(function(t){return i.isLoading=!1,console.warn("Interlink: Failed to fetch links",t),[]})),this.loadingPromise)},findLink:function(t){return this.links?this.links.find(function(e){return e.key===t}):null},generateReplacement:function(t,e){const n=e||t.displayName;return t.url&&t.url.trim()?'<a href="'+this.escapeHtml(t.url)+'" target="_blank" rel="nofollow">'+this.escapeHtml(n)+"</a>":this.escapeHtml(n)},escapeHtml:function(t){const e=document.createElement("div");return e.textContent=t,e.innerHTML},replacePlaceholders:function(t){const e=this;return t.replace(i,function(t,n,i,o){const r=e.findLink(n);return r?e.generateReplacement(r,o):e.options.customFallback(n,o)})},processNode:function(t){const e=this;if(t.nodeType===Node.TEXT_NODE){const e=t.textContent,n=this.replacePlaceholders(e);if(e!==n){const e=document.createElement("div");e.innerHTML=n;const i=document.createDocumentFragment();for(;e.firstChild;)i.appendChild(e.firstChild);t.parentNode.replaceChild(i,t)}}else if(t.nodeType===Node.ELEMENT_NODE){if("SCRIPT"===t.tagName||"STYLE"===t.tagName)return;Array.from(t.childNodes).forEach(function(t){e.processNode(t)})}},processDocument:function(){this.links?this.processNode(document.body):console.warn("Interlink: No links loaded")},init:function(){const t=this;this.fetchLinks().then(function(){t.processDocument()})}},window.Interlink=s,function(){const t=document.querySelector("script[data-user-id]");if(t){const e=t.getAttribute("data-user-id"),n="false"!==t.getAttribute("data-replace-all");if(e){const t=new s(e,{replaceAll:n});"loading"===document.readyState?document.addEventListener("DOMContentLoaded",function(){t.init()}):t.init()}}}()}();