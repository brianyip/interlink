(()=>{let i={apiBaseUrl:"https://your-domain.vercel.app/api/public/links",cacheKey:"interlink_links_cache",cacheExpiry:3e5,placeholderPattern:/\{\{([^}|]+)(\|custom=([^}]+))?\}\}/g},r={get:function(e){try{var t,n=localStorage.getItem(e);return n?(t=JSON.parse(n),Date.now()>t.expiry?(localStorage.removeItem(e),null):t.value):null}catch(e){return null}},set:function(e,t,n){try{var i={value:t,expiry:Date.now()+n};localStorage.setItem(e,JSON.stringify(i))}catch(e){}}};function t(e,t){this.userId=e,this.options=Object.assign({replaceAll:!0,customFallback:function(e,t){return t||"{{"+e+"}}"}},t||{}),this.links=null,this.isLoading=!1}if(t.prototype={fetchLinks:function(){let t=this,n=i.cacheKey+"_"+this.userId;var e=r.get(n);return e?(this.links=e,Promise.resolve(e)):(this.isLoading||(this.isLoading=!0,this.loadingPromise=fetch(i.apiBaseUrl+"/"+this.userId).then(function(e){if(e.ok)return e.json();throw new Error("Failed to fetch links: "+e.status)}).then(function(e){return t.links=e,t.isLoading=!1,r.set(n,e,i.cacheExpiry),e}).catch(function(e){return t.isLoading=!1,console.warn("Interlink: Failed to fetch links",e),[]})),this.loadingPromise)},findLink:function(t){return this.links?this.links.find(function(e){return e.key===t}):null},generateReplacement:function(e,t){t=t||e.displayName;return e.url&&e.url.trim()?'<a href="'+this.escapeHtml(e.url)+'" target="_blank" rel="nofollow">'+this.escapeHtml(t)+"</a>":this.escapeHtml(t)},escapeHtml:function(e){var t=document.createElement("div");return t.textContent=e,t.innerHTML},replacePlaceholders:function(e){let o=this;return e.replace(i.placeholderPattern,function(e,t,n,i){var r=o.findLink(t);return r?o.generateReplacement(r,i):o.options.customFallback(t,i)})},processNode:function(e){let t=this;if(e.nodeType===Node.TEXT_NODE){var n=e.textContent,i=this.replacePlaceholders(n);if(n!==i){for(var r=document.createElement("div"),o=(r.innerHTML=i,document.createDocumentFragment());r.firstChild;)o.appendChild(r.firstChild);e.parentNode.replaceChild(o,e)}}else e.nodeType===Node.ELEMENT_NODE&&"SCRIPT"!==e.tagName&&"STYLE"!==e.tagName&&Array.from(e.childNodes).forEach(function(e){t.processNode(e)})},processDocument:function(){this.links?this.processNode(document.body):console.warn("Interlink: No links loaded")},init:function(){let e=this;this.fetchLinks().then(function(){e.processDocument()})}},window.Interlink=t,o=document.querySelector("script[data-user-id]")){var n=o.getAttribute("data-user-id"),o="false"!==o.getAttribute("data-replace-all");if(n){let e=new t(n,{replaceAll:o});"loading"===document.readyState?document.addEventListener("DOMContentLoaded",function(){e.init()}):e.init()}}})();